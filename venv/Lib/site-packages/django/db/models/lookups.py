import itertools
import math
import warnings

from django.core.exceptions import EmptyResultSet, FullResultSet
from django.db.backends.base.operations import BaseDatabaseOperations
from django.db.models.expressions import Case, Expression, Func, Value, When
from django.db.models.fields import (
    BooleanField,
    CharField,
    DateTimeField,
    Field,
    IntegerField,
    UUIDField,
)
from django.db.models.query_utils import RegisterLookupMixin
from django.utils.datastructures import OrderedSet
from django.utils.deprecation import RemovedInDjango60Warning
from django.utils.functional import cached_property
from django.utils.hashable import make_hashable


class Lookup(Expression):
    lookup_name = None
    prepare_rhs = True
    can_use_none_as_rhs = False

    def __init__(self, lhs, rhs):
        self.lhs, self.rhs = lhs, rhs
        self.rhs = self.get_prep_lookup()
        self.lhs = self.get_prep_lhs()
        if hasattr(self.lhs, "get_bilateral_transforms"):
            bilateral_transforms = self.lhs.get_bilateral_transforms()
        else:
            bilateral_transforms = []
        if bilateral_transforms:
            # Warn the user as soon as possible if they are trying to apply
            # a bilateral transformation on a nested QuerySet: that won't work.
            from django.db.models.sql.query import Query  # avoid circular import

            if isinstance(rhs, Query):
                raise NotImplementedError(
                    "Bilateral transformations on nested querysets are not implemented."
                )
        self.bilateral_transforms = bilateral_transforms

    def apply_bilateral_transforms(self, value):
        for transform in self.bilateral_transforms:
            value = transform(value)
        return value

    def __repr__(self):
        return f"{self.__class__.__name__}({self.lhs!r}, {self.rhs!r})"

    def batch_process_rhs(self, compiler, connection, rhs=None):
        if rhs is None:
            rhs = self.rhs
        if self.bilateral_transforms:
            sqls, sqls_params = [], []
            for p in rhs:
                value = Value(p, output_field=self.lhs.output_field)
                value = self.apply_bilateral_transforms(value)
                value = value.resolve_expression(compiler.query)
                sql, sql_params = compiler.compile(value)
                sqls.append(sql)
                sqls_params.extend(sql_params)
        else:
            _, params = self.get_db_prep_lookup(rhs, connection)
            sqls, sqls_params = ["%s"] * len(params), params
        return sqls, sqls_params

    def get_source_expressions(self):
        if self.rhs_is_direct_value():
            return [self.lhs]
        return [self.lhs, self.rhs]

    def set_source_expressions(self, new_exprs):
        if len(new_exprs) == 1:
            self.lhs = new_exprs[0]
        else:
            self.lhs, self.rhs = new_exprs

    def get_prep_lookup(self):
        if not self.prepare_rhs or hasattr(self.rhs, "resolve_expression"):
            return self.rhs
        if hasattr(self.lhs, "output_field"):
            if hasattr(self.lhs.output_field, "get_prep_value"):
                return self.lhs.output_field.get_prep_value(self.rhs)
        elif self.rhs_is_direct_value():
            return Value(self.rhs)
        return self.rhs

    def get_prep_lhs(self):
        if hasattr(self.lhs, "resolve_expression"):
            return self.lhs
        return Value(self.lhs)

    def get_db_prep_lookup(self, value, connection):
        return ("%s", [value])

    def process_lhs(self, compiler, connection, lhs=None):
        lhs = lhs or self.lhs
        if hasattr(lhs, "resolve_expression"):
            lhs = lhs.resolve_expression(compiler.query)
        sql, params = compiler.compile(lhs)
        if isinstance(lhs, Lookup):
            # Wrapped in parentheses to respect operator precedence.
            sql = f"({sql})"
        return sql, params

    def process_rhs(self, compiler, connection):
        value = self.rhs
        if self.bilateral_transforms:
            if self.rhs_is_direct_value():
                # Do not call get_db_prep_lookup here as the value will be
                # transformed before being used for lookup
                value = Value(value, output_field=self.lhs.output_field)
            value = self.apply_bilateral_transforms(value)
            value = value.resolve_expression(compiler.query)
        if hasattr(value, "as_sql"):
            sql, params = compiler.compile(value)
            # Ensure expression is wrapped in parentheses to respect operator
            # precedence but avoid double wrapping as it can be misinterpreted
            # on some backends (e.g. subqueries on SQLite).
            if not isinstance(value, Value) and sql and sql[0] != "(":
                sql = "(%s)" % sql
            return sql, params
        else:
            return self.get_db_prep_lookup(value, connection)

    def rhs_is_direct_value(self):
        return not hasattr(self.rhs, "as_sql")

    def get_group_by_cols(self):
        cols = []
        for source in self.get_source_expressions():
            cols.extend(source.get_group_by_cols())
        return cols

    def as_oracle(self, compiler, connection):
        # Oracle doesn't allow EXISTS() and filters to be compared to another
        # expression unless they're wrapped in a CASE WHEN.
        wrapped = False
        exprs = []
        for expr in (self.lhs, self.rhs):
            if connection.ops.conditional_expression_supported_in_where_clause(expr):
                expr = Case(When(expr, then=True), default=False)
                wrapped = True
            exprs.append(expr)
        lookup = type(self)(*exprs) if wrapped else self
        return lookup.as_sql(compiler, connection)

    @cached_property
    def output_field(self):
        return BooleanField()

    @property
    def identity(self):
        return self.__class__, self.lhs, self.rhs

    def __eq__(self, other):
        if not isinstance(other, Lookup):
            return NotImplemented
        return self.identity == other.identity

    def __hash__(self):
        return hash(make_hashable(self.identity))

    def resolve_expression(
        self, query=None, allow_joins=True, reuse=None, summarize=False, for_save=False
    ):
        c = self.copy()
        c.is_summary = summarize
        c.lhs = self.lhs.resolve_expression(
            query, allow_joins, reuse, summarize, for_save
        )
        if hasattr(self.rhs, "resolve_expression"):
            c.rhs = self.rhs.resolve_expression(
                query, allow_joins, reuse, summarize, for_save
            )
        return c

    def select_format(self, compiler, sql, params):
        # Wrap filters with a CASE WHEN expression if a database backend
        # (e.g. Oracle) doesn't support boolean expression in SELECT or GROUP
        # BY list.
        if not compiler.connection.features.supports_boolean_expr_in_select_clause:
            sql = f"CASE WHEN {sql} THEN 1 ELSE 0 END"
        return sql, params

    @cached_property
    def allowed_default(self):
        return self.lhs.allowed_default and self.rhs.allowed_default


class Transform(RegisterLookupMixin, Func):
    """
    RegisterLookupMixin() is first so that get_lookup() and get_transform()
    first examine self and then check output_field.
    """

    bilateral = False
    arity = 1

    @property
    def lhs(self):
        return self.get_source_expressions()[0]

    def get_bilateral_transforms(self):
        if hasattr(self.lhs, "get_bilateral_transforms"):
            bilateral_transforms = self.lhs.get_bilateral_transforms()
        else:
            bilateral_transforms = []
        if self.bilateral:
            bilateral_transforms.append(self.__class__)
        return bilateral_transforms


class BuiltinLookup(Lookup):
    def process_lhs(self, compiler, connection, lhs=None):
        lhs_sql, params = super().process_lhs(compiler, connection, lhs)
        field_internal_type = self.lhs.output_field.get_internal_type()
        if (
            hasattr(connection.ops.__class__, "field_cast_sql")
            and connection.ops.__class__.field_cast_sql
            is not BaseDatabaseOperations.field_cast_sql
        ):
            warnings.warn(
                (
                    "The usage of DatabaseOperations.field_cast_sql() is deprecated. "
                    "Implement DatabaseOperations.lookup_cast() instead."
                ),
                RemovedInDjango60Warning,
            )
            db_type = self.lhs.output_field.db_type(connection=connection)
            lhs_sql = (
                connection.ops.field_cast_sql(db_type, field_internal_type) % lhs_sql
            )
        lhs_sql = (
            connection.ops.lookup_cast(self.lookup_name, field_internal_type) % lhs_sql
        )
        return lhs_sql, list(params)

    def as_sql(self, compiler, connection):
        lhs_sql, params = self.process_lhs(compiler, connection)
        rhs_sql, rhs_params = self.process_rhs(compiler, connection)
        params.extend(rhs_params)
        rhs_sql = self.get_rhs_op(connection, rhs_sql)
        return "%s %s" % (lhs_sql, rhs_sql), params

    def get_rhs_op(self, connection, rhs):
        return connection.operators[self.lookup_name] % rhs


class FieldGetDbPrepValueMixin:
    """
    Some lookups require Field.get_db_prep_value() to be called on their
    inputs.
    """

    get_db_prep_lookup_value_is_iterable = False

    def get_db_prep_lookup(self, value, connection):
        # For relational fields, use the 'target_field' attribute of the
        # output_field.
        field = getattr(self.lhs.output_field, "target_field", None)
        get_db_prep_value = (
            getattr(field, "get_db_prep_value", None)
            or self.lhs.output_field.get_db_prep_value
        )
        if not self.get_db_prep_lookup_value_is_iterable:
            value = [value]
        return (
            "%s",
            [
                (
                    v
                    if hasattr(v, "as_sql")
                    else get_db_prep_value(v, connection, prepared=True)
                )
                for v in value
            ],
        )


class FieldGetDbPrepValueIterableMixin(FieldGetDbPrepValueMixin):
    """
    Some lookups require Field.get_db_prep_value() to be called on each value
    in an iterable.
    """

    get_db_prep_lookup_value_is_iterable = True

    def get_prep_lookup(self):
        if hasattr(self.rhs, "resolve_expression"):
            return self.rhs
        prepared_values = []
        for rhs_value in self.rhs:
            if hasattr(rhs_value, "resolve_expression"):
                # An expression will be handled by the database but can coexist
                # alongside real values.
                pass
            elif self.prepare_rhs and hasattr(self.lhs.output_field, "get_prep_value"):
                rhs_value = self.lhs.output_field.get_prep_value(rhs_value)
            prepared_values.append(rhs_value)
        return prepared_values

    def process_rhs(self, compiler, connection):
        if self.rhs_is_direct_value():
            # rhs should be an iterable of values. Use batch_process_rhs()
            # to prepare/transform those values.
            return self.batch_process_rhs(compiler, connection)
        else:
            return super().process_rhs(compiler, connection)

    def resolve_expression_parameter(self, compiler, connection, sql, param):
        params = [param]
        if hasattr(param, "resolve_expression"):
            param = param.resolve_expression(compiler.query)
        if hasattr(param, "as_sql"):
            sql, params = compiler.compile(param)
        return sql, params

    def batch_process_rhs(self, compiler, connection, rhs=None):
        pre_processed = super().batch_process_rhs(compiler, connection, rhs)
        # The params list may contain expressions which compile to a
        # sql/param pair. Zip them to get sql and param pairs that refer to the
        # same argument and attempt to replace them with the result of
        # compiling the param step.
        sql, params = zip(
            *(
                self.resolve_expression_parameter(compiler, connection, sql, param)
                for sql, param in zip(*pre_processed)
            )
        )
        params = itertools.chain.from_iterable(params)
        return sql, tuple(params)


class PostgresOperatorLookup(Lookup):
    """Lookup defined by operators on PostgreSQL."""

    postgres_operator = None

    def as_postgresql(self, compiler, connection):
        lhs, lhs_params = self.process_lhs(compiler, connection)
        rhs, rhs_params = self.process_rhs(compiler, connection)
        params = tuple(lhs_params) + tuple(rhs_params)
        return "%s %s %s" % (lhs, self.postgres_operator, rhs), params


@Field.register_lookup
class Exact(FieldGetDbPrepValueMixin, BuiltinLookup):
    lookup_name = "exact"

    def get_prep_lookup(self):
        from django.db.models.sql.query import Query  # avoid circular import

        if isinstance(self.rhs, Query):
            if self.rhs.has_limit_one():
                if not self.rhs.has_select_fields:
                    self.rhs.clear_select_clause()
                    self.rhs.add_fields(["pk"])
            else:
                raise ValueError(
                    "The QuerySet value for an exact lookup must be limited to "
                    "one result using slicing."
                )
        return super().get_prep_lookup()

    def as_sql(self, compiler, connection):
        # Avoid comparison against direct rhs if lhs is a boolean value. That
        # turns "boolfield__exact=True" into "WHERE boolean_field" instead of
        # "WHERE boolean_field = True" when allowed.
        if (
            isinstance(self.rhs, bool)
            and getattr(self.lhs, "conditional", False)
            and connection.ops.conditional_expression_supported_in_where_clause(
                self.lhs
            )
        ):
            lhs_sql, params = self.process_lhs(compiler, connection)
            template = "%s" if self.rhs else "NOT %s"
            return template % lhs_sql, params
        return super().as_sql(compiler, connection)


@Field.register_lookup
class IExact(BuiltinLookup):
    lookup_name = "iexact"
    prepare_rhs = False

    def process_rhs(self, qn, connection):
        rhs, params = super().process_rhs(qn, connection)
        if params:
            params[0] = connection.ops.prep_for_iexact_query(params[0])
        return rhs, params


@Field.register_lookup
class GreaterThan(FieldGetDbPrepValueMixin, BuiltinLookup):
    lookup_name = "gt"


@Field.register_lookup
class GreaterThanOrEqual(FieldGetDbPrepValueMixin, BuiltinLookup):
    lookup_name = "gte"


@Field.register_lookup
class LessThan(FieldGetDbPrepValueMixin, BuiltinLookup):
    lookup_name = "lt"


@Field.register_lookup
class LessThanOrEqual(FieldGetDbPrepValueMixin, BuiltinLookup):
    lookup_name = "lte"


class IntegerFieldOverflow:
    underflow_exception = EmptyResultSet
    overflow_exception = EmptyResultSet

    def process_rhs(self, compiler, connection):
        rhs = self.rhs
        if isinstance(rhs, int):
            field_internal_type = self.lhs.output_field.get_internal_type()
            min_value, max_value = connection.ops.integer_field_range(
                field_internal_type
            )
            if min_value is not None and rhs < min_value:
                raise self.underflow_exception
            if max_value is not None and rhs > max_value:
                raise self.overflow_exception
        return super().process_rhs(compiler, connection)


class IntegerFieldFloatRounding:
    """
    Allow floats to work as query values for IntegerField. Without this, the
    decimal portion of the float wouldQ>»ù[> Ğ¹>²¦>¨UŠ>3•Ø>P Ù>6­>¡Í>|¯¬>‹t•½Ú"Ê½ı`,½“i4¾Ê,=¾Ÿ²½½/½úk½ÆÆì¹‹­ >k©>S >$Ø’>q€>TĞn>ı‘U>F…;>‚ ¬=?Æ›º‰½>l›½=QI½Ãk½»î½d ½.ª½ƒAk½Lp;Ü 3=¾ rº9¯-=Ìk:½€Q<í$¹=d#}½²7~½u±r¾-­'¾ íø½
v¾‚±.¾Š¤ë½w*U¾yK¾]ß ¾‡‰¾Úæ†¾ªƒ¾º„†¾)Är¾nA>¾,”u¾­Èb¾Æƒ ¾Ï2
>³Ğ6>¥Ô >ÄëÇ=
>9½ï=pzš=ã[>lš=Î¡=1ò>6ÛÎ=0Ï<VÎä=wÄV=…Ê‚=V‹Í=~3¦=uüí=Õf>y/÷=@§Î=ª*>%C9>=ë>ê<J>:	6>¸¸>Ãİ‚>ÿ7«>ì”•>‘>à#¯>_ñ>_è>Uiá>ä õ=¦ô=´ÔL>x=~B…=şå9>¨(>?Ë>ñ[>Ñİ<è*¶=D7'>Elî½¶nÀ»¸¥‹=O4)¾§ÿ¼’i»ß¶S»îd=šš=˜“=Ì6>á÷	>I>¯º9>h…H>Ç,Š½M¿½g´¼F+ö½dd£½‡¿½éè®½L8´½O½†½$Il>2¼U>ˆ{©>>ÆŒ>¸_‰>¾>?”­>Æı³>t1«>µ£î> ô>èÏä>ªuÜ>õ»¼>ñ0 >ïî>}Æ>x;o>}¿<;Ÿ¾¼©Í$=ÅÀ½œw‘½wkí<T:»IÂ½•ë =UO=`0=ûËÊ=NÁR=(cx=`­‹=¤Ór=YG2=ÂÃ=ğ_â¼ªm½`†½äSS¼¦l½]ÀÁ½Ú5ì;,a)½˜n½Y#>‡D=u˜€½ßíÌ=^÷Y½J:­Ï=…¹ş;œGÂ=¬9>Î6^>M—”>»µv;ño/=›àl>¬M< ·l=ó!Š>±qš>ê+‹>ØÜ>vŠ­>„¸>áá»> ”–>Sù¨>5g >Ewù½“§Ô½5‘½"{ä½SMÎ½ge¤½;(Ä½=|°½Âƒ´½¹`Œ½¢ø½Áÿ	¾£¤½ØŞö½_&¾š¼»½øê ¾)ä*¾ÀÇU½j ª½Aà½Ÿ+}½÷Ù¾½âØ½¡^½‘V¤¼4ua½&F~>ù&>]9.>·5ó=[#<äû2»/í>¶ÎÀ¼}ñ$¼7Y¾s.¾¡’-½2ë¾Ôc¾a·<.ÿ¨½2E.»/=Àhy>_V>>¼=›>Á)]>æ0š>‡©è>›ÄÃ>¯Ò>à–“½†­ßº©7.¼×Ù½Ím½YØë»|…½ —»æs•;ëÃ½=pÜà=G|&>Ú¥ª=™É=FI1>¡¡>|¾
>ö,v>-m·>T¨>?¼>+‡>ùNu>ÀÕ¿=ş7>E)=úhÎ<ï:C=_–;›­7=œUB½°$I½÷œ]=K
	=;‹U=1>»®X>|~P>†~d>g¬>uH/>†3>+ã:>:J>¤z>ı¬Œ=!R=áY>EùÜ¼Â6&<™GI=ë2<‰|V¹D>Ê=J2>;ø=ĞX>®÷ƒ>„->¶Aƒ>	ª>9Â†>Š<Ê>"›½9“8½å€/=Y®È;éi½ú>¤=üM>GÙ¢=¦)>$l-> :>¢ñB>£pû=Î¸#>n$>çL>pØ>õê>Ç¾Ñ=R•>†N®>)áW>:Á>—Ç>k¹A>E¹¸>J1Â>¤2í½îø¼½øiÎ½şBà½ÕÓÚ½O¾Åè¶½ êµ½“:½ı‘Ä¼šª½‚vu¼=w¤<Ÿã»;{
»C«>ãèİ=£ÏØ=½>Ğ÷µ>†q>Â—s>‘F›>p;‹>iã.>ÈG>äÙA>Ûm½¼ë¾{eš½,ıˆ¼ƒş±½ríÇ»ë®‘=½ñÙŞ=~†ı=K=w=)òç=wfÿ¼C\><«£·=IÓŞ=°Ü]=§z!>ıé>?¸=Ó‘>‘üİ=¯~=¹/ä=Ë›=]Y;‡Ë›<‡Œº=kÀJ>Üç¼èš=°•@>wë¼zò6=m^>‡â¯¾}d¢¾ bY¾äË¾&,€¾‘I¾Æ×Õ¾ h]¾ÍL>¾è$°=ìç—=%Ñ=Æ‘n=—¼àŠ=4Ë=Â¤‹=;uì=Ä¡0¼’¥¼N~½ú„½»G¼½ğ›¡½á%¾Î`é½mÙ¾XR¾±X<¾zÏ¾ğ¾„R?¾l×ß½iá½l¾^¦«½şo‚>7m:>Jvr>“Úo>”	>>n3›>Ë•â=…8³<µÈ=Ü³>´O>æ¦ <ªŞ=(Œ‰=æ­C=6	=]è»òp>–>%R>L-&>È\>ŒğR>yÎ>†z.>Ğc>›Š=IQ‘¼9Óœ=¬¡µ¼½\½¢ÿ»±—¢<[æP<°¤s=…Å0>jò>ñÕ!>«rÌ=w-r=w=³–m=¬#|=²…»r@¾Yrı½_ˆ¾z9¾_¾$ Ö½+æ×½<K¾V­½»£½.ï½Ûzê½$Ùœ½ñæ½’¨¿½‹U½í-±½6Ô¼-‰.¼¹ş½éš”<QÖ¡<3õŸ½9
<¤kÓ;uñÈº_(=fƒ¡>§2Å>ÖA»>P´¢>÷Æ>dÂ¥>Œ–>Îcœ>Éï‹>·æ½²¾¦¾›QÍ½`zø½å´½ºv½¥E½[~¢½Û¾½ÿrã½Ó¹§½\´å½¶=Ñ½B¨¾Gh½ÈFğ½æ?½½Óox¾#Re¾"=¾½¦¾ê$¾â¿ğ½fÏ¾ZÙÛ½’•½SK°>ŞÖ>¬UÖ>ß«×>IÜë>¸Õ>¾ë>™Üê>¼ê>Ç£m>¸ï†>ÂG>TF>p¿1>íYò=§È>”ğı=S-ô=U.$=Ã¤Ü=–yn>(®¾»ü¥=ÎÖ&>×ş~=,à;`M>iÖ>ëQµ>]ä¿>Lö‡>‹3²>9ß¡>3>ë¿¨>·ã’>5cp½4âä½¼æÄ½-ºİ¼:¾MWg½í?=åƒ½ŠC<şåM=š¼kÄ½=Ìz¸¼T»fßÍ=á{
½Ğ\µ¼¿ ¡=îÎ>n6$>óFf>D×@>/ÂL>–ØE>ÒBg>Døg>ãş‚>Ç”Q½;¯×¼¹Ú¼ˆÃ¾¤Á½•2€½Õ/j=ãj;0¤_¼ÂVa½Kƒ°½]Ë¼Ôª½8ÕÜ½X‚’½tË#=¬³ş¼ë$4=æ*½1ç½”v‹½f>À¼õ†½¢7½¨†á¼<Š™¼±Ê;ÍÁ¯=v =>ñ®>ºCÀ=.s:>ªu>yÌ=:ˆ=>æ©>cÍ=ã>Zõ">Ğí</¢>³67>Ã™†=€Áé=W_€>3*}>Ş¶a>–ĞO>bå>®èô=%q->Ï™=a‡›=û:=†–¾†Ø½³ñJ½İ[½“ë‹¼ãw ={Ş ¼±–<áŠ=Jq>˜¬Ã>M¿>‘¡>Ë>sÔ¨>Wéœ>7Ó>/Ø—>jÔÛ<³¶=Ìja>qş¼ÔD#¼¦>Ñ­4=†õ3<õ›>ñ>Ì”á>NèÑ>xÔ>Ì£‹>-­>¥ã>n¢¥>î«>|²s>R¬ß>³ÜÕ>Œƒœ>äK?ÀÀç>,&Ğ>f!?™æ>AT>	€¹=->´–L>e#>Le>å
{>Ò1>>èvê½ltï½µ¾	ß¾Û¾:€ö½]i¾İÚ½)¾­½±Y>ÆA9>ås>u*‹> õ>ª–ò=Ûà\>·U«=õ`˜=±ú°>_å¶>¿@Ä>«|¬>„—¤>Ş®>=O†>V">ª+9=1Ë½¿¼¾4ç½âLë½ø ¾øÖâ½íH½ªÌ½=µ‘½¥ƒ>%> ¨q>„D•='z¯=•'B>é?H>áU/>ìó_>­:Û>û·>ôò‘>e¸>Ò—>$;>EÃ>äâM>¬`¨=*E±>n¶>²Î§>9)¹>4@¥>¿>C2‡>l‚>b>ˆÓ½_{ù½à'×½}’½Ú¿¶½bšb½FŒ½‰¹}½–j˜¼µÑ%=Ú«=’èæ=+³!»“aà¼ •=n‹¼:ğ?½`¹Š=óÙ®=½=€>aòh>ÓIf=	¸·=‹~?>éŒŒ¼Ót·<ç³Ë=_¤>=D	Õ=ó–¡=]¢¼‹„=–S<öjß¼¦·è¼øg"½ÿ
>’\¬=¨5¿=ì=ˆ=[,®=›Ëh=­Á«=G†=ˆá=Wô³>~_>h_†>ü´–>´š>k2æ=IFŒ>ëÊ…=ğ—=L'r=ı]=m2<×§¤<•¬§»Ó†V<1÷ù<¦x'=ES=Eq¾Q„¾·:t¾´h¢¾fV¹¾]M„¾4Ã¾†°‰¾+†<¾¬> $ê=o
6>^·r=+½Ú=	 >R€‹=à¶>ö.n>¤¥f>c¨~>òÕœ>×`>ı—>Ğæ¦>„‹[>	q„>>É×+>Ö=D>¾„4>G>EO#>Y½|>ñN>X>7;>Í#>Ò›©=Ô=¸E=	Cš=)Š½zù¼o‹¼¦­ƒ>oK>yàR>	ôq>lî=
ç>êÀ…>Ê=Yªô=õÅ½:…Ä½²¦Î½(ğú¼ôÍ¾Ëe?¾"İÀ»ô\F¾°÷˜¾{Ï¾bî¾Øe¾Ò¾S8¾¾›ş½`İ½£¾¢›#¾>²f>qt>L‡>„‹¨>ëÉ>Ù„¯>X+¯>¡4¯>¡&·>?R—>T®{>â7>¼o~>(ÏE>êrø=Ôo>M-á=ÏJ®=§}-¾d¾;¾`”i¾R&–½÷£1½DyÍ½!øh=-Ò¨=b=ò^›> Ï>¸à¯> ºÄ>Ãõà>•˜Ì>.ò¡>yÈ>=‹Å>_<<L˜¼1 ½Jª¾½:B„½óy½yå ½8µ‚½•ï½a­¾N…:¾c¾%uÈ½O}µ½”²â½7½»ÁÇ½æD=l=·&
>İ‹;W›½OĞµ<Ñ+İ=šÍ‚=Š°À=\zÔ>FØ>×xÅ>|á>q|×>Äñ­>Â‰³>m’¦>%ëy>U/=ÔK=çvû= °=×0ƒ=d¯¿=>÷=É«,>RPù½¸Ÿ ¾#G¾&¾˜.ù½MŠ¾TÈ°½{7ö½…	õ½~W˜>–ºq>%é>tık>dô>s!>>ş:k>Ø‡=OŞ=pĞ—>õºœ>+ ?Ô•³=¹­/>·?©¸>$ëÒ>³?úğ¼¼>
,;>!=_‰‚>V†‰>ˆú=Nµn>)°…>êtK>³5>çŞ'>¸¥=Ï
>\]#>%G=ß±Ò=³ˆ>pÅM>ï>”>‘¦F>of>:‹>rYÆ>Kw‰>Ó;¬>TY€¾k¾»†¾å%¾`¿¾d’¾¾&¾]˜³¾¿·Î¾ZM=İğg¼°Û§=¡‚è»¾u¾ü5½oÏÈ=Ôi½;	rU=$“;>CÚƒ½OX½EXı=<Ùâ½å½ça*>½ú«½Fy½‹D	>VRç;JJy>M~‘> PY>qHh>  Ç>5é>¶lT>¶I>è¥<[W–<5zŸ=ÇÊx¾Á!¾“OŸ»<¾D¾}Ö,¾ß‰<‡xº=‚1>5ê¼jø<>_E>¾=–i>,~]>GßÉ;hc—<ô(°»÷™q½Á©½¼–½èï½ã8¸½ùV˜½Nmî½ñL¾PQ¾ÀPF¾’JŠ¾^…¾ó$¾¿ug¾=Tk¾k¶b¾Nv¾Ãrƒ¾èçw¾õj³¾Ä¾G““¾·»¾ç*Î¾Èrˆ;Râ<¿à¡<¸Q=¢‚=ââ›½cŸ>î–=š×7½ÎfK>Z(ù=8Şõ=,+\>øPº½î3<,&9>3£=¶SÔ=Z>í–†>*ê?wP>tW>B£­>’{¡>Št>Wm©>I³¦:I£½ş<ª½ö—ä½¨;b¾PÌ@¾¹UŸ½×I%¾S@6¾#¦[¼îIŞ¼Æ®=`1%;"§{=TÔ>XPµ=M>ç{$>%ØÏ¾ñwÅ¾v¸¾ôfÅ¾øsÁ¾SwÅ¾b²¾`À¾Éåá¾·Ì >®8>&!<>ôÉ¼/S=40=fm9=uÿü;' =S~Š>€Ft>Hä‚>g0ƒ>©¬Í>óµ>—Õ•>ş¡®>İ÷£>B©o>kèi>¸n¨>q¶>À®1>“7‚>\ğh>æ2>¹“>ÿ‡>{D{>­ò²>í
\>ˆ÷D>3v>¤ËÄ>Êš>‚EÁ>‰ÏC>Hq¾=h¬¼^¶í=1d%¾1¾™b>Ù¡í½;’¾;eİ¨>LG>kö>>‚Oœ=íx“>W›>}T¼!%‚>2>ú>½Š>tæ­>¸“>#$>ñ]”>éZ[>û>ÊéÙ¼àğâ½RÒş½óñ½Bá½U7¾à^—=(~½òv~½Y©"¾Õ@N¾Ÿåh¾Ë±H¾Óğb¾?s¾©ˆ ¾\m%¾İ¬Á½>)=ü=;<Z>°ß=^V1>Xga>%)>¦U>ªic>Pd6¾z¾6ëj¾„¾a¾ŒGj¾îÎh¾Ä.\¾w¾ÙÍJ=.0 ½%¾¹"½İe>¾-1Ÿ¾ÕÉ¼èõ‹¾şôu¾ø=/®y¼ëm	>,†:o¢Z=->´ˆ/>v6ª=ù¬Ø=uLV>62©>[Æ>È(>Ş¢©>ÙK§>)>¢>)Øå>#7Î>Çxm=÷Hº;øğT=<á†<köT=ğğX=áu=à„¼ĞŠL¼­…>&ÏÀ¼y>rÛ‡½oÇ¾E>Ù÷/=amZ½x5v>t»?zÌ>p?î/>Ä8å>W6	?;@Ñ>|<?ÉÈ!?†T¾0RŠ¾0Ù¾ßá©¾“ÙÄ¾ÄìÑ¾&+Ñ¾6BÒ¾×Ì¾‘O½)¡½¸Ò½¯í"<~É=lÇ=/ğ<Îv>Aî=iD½õû¡=°Õƒ>ÕÉô½# öºÜ…O>Q©+¾eîÃ¼A'>Ê›S=¥M½-³½“
R½œÛ½B j¾µãˆ¼¨œ¢½w/(¾™²:¾)·¾nf¢¾c†.¾p«š¾CÁ¾7¡F¾×¯š¾i¶¾Jv‰>vÜ•>š´€>”û“>8§>8Ÿ>b©>¨Ç>N„‡>‘Í9¾	>¾…Ş5¾ºw	¾·œK¾ò^¾åÈ¾à^¾90¾«
>øP¼r#¬=ûÔ>Wñ©½	Ø¼ÃÕ‚>ô…X=‡Â´=)>õ×®½è¾÷:Ò=)¾í€7¾)¾È=åNE¾É—u¾¦òl¼ôLy½ÿDĞ½UĞ½Lğe¾äÈŠ¾ø§½?NJ¾b![¾£÷³¾(†ô¾,º¿Ğe•¾Eú¾eïô¾GÏ¯¾tZş¾Ñ¾¿eİt>Õ>áˆç>>2 ?\Å?]Õ>¢Ø	?vC?êÀ>Aü4>pJ²>Ú[b>µ5ê<æá5>ŞùÒ>­¸V>–W>okj;¡	ñ»nü¬½èFg<ß
(½yjÃ½²>—F·¼eë:¼¾“£>‡X>SVÜ>XÅË=¡U=®e{>À>:€¨>éãÏ>O<i<İ½ p[;Íæ>½°„¾<p¾/¦½Ÿ«ÿ½ı`Ó½(°~>îÑ‰>üó®>H E>õÔ—=i$!>ÿª>v7>‰—>RÊ½¿^Ş½ â×¼wgz½¾‰d=óËc=ÅÇ==œÇø=;Â>¸³n¼(, <•W½‚$»ÚÃ<’Ş¼sÈ¼ÁnÚ;™ò·;$+=Ÿæ@=9ÅÆ¼ïQ¼toº½ü’ü½hç²½´Ù½ .¾¯Ë1>±\>¥*0>MQH=X7í¼òVš=_º’=¨]P=¶³/>c?cE>eèî>÷g€>OÊ=S!ğ>Œ?â$¢>*•(?µ†¾‡ÔL¾#I¾G]¾”+©¾6‘˜¾d2[¾â¨¾ê²¾w³.?´Š'?5—2?Ç”‰>°H>’½®>Ä'İ>º°>kqó>æpÜ¾/õÄ¾ ¾u’¾1°»¾%Éx¾…8¾F Ã¾°™¾HN>¬ßr¼Ÿ„–=Ë0>‰5¾%­z½dˆY>X'½Dæ`<È“<sİŸ=2>[p$»wí½=(e>Q;š½âR=X˜·=Yio½e¦P½^í¯;°lŠ½°è=x(!=é¶’<È9{=4û£=¬,½“õ½#ã'¾zß»½Ö“W¾ìŸ~¾Ëi¾½J„¾äLT¾Îš›>âïè=c¦>­r>8œ”=ÑóB>i£>Ó©Í=ä–n>t†l=ƒ=|º“=¢.ñ<ŞK<â™¼š½;ˆ*½_'‚½$¬O>ÁÉ>ùşì>›˜>ËJ?Êí>>¡æ>H?ĞÃı>=>AYÚ=ù¬O=Lm=óT)<!ã½«3ñ=-ğ0;W0½ÎOC>²d>pâz>4>¸,>Kª”>¤ú==&…>ç>Î¼T½Ò>Õ*>X¾¨=¢&Ó>o >]ÓS=Vlv>lY>,dÍ½K{”½¤D=ƒrë¼§¶¼«:=©…¼©¶=Íu<›º¾J¾5
[¾'|`¾W«¾6yÇ¾y“¾¢Î¦¾Ãq­¾#ÿ°½¿®^½¶{¼µ”½Û	¡=Ãs»=êÒƒ=ÀSê=<Uğ=&¦ö½¡±İ:¥Iœ=- ½xë=È8>æ“½%v†=sà>?K½ù¹ô<2İS<e¿i½4Á=>%>É j=5"T>ˆŞ\>ºT¾ØÆ¾¾É“x¾Fâ°¾½ùı¾8–Ğ¾?aş½ğOã¾G­¾·=OÉú½x¬½6hp½¢š‹¾)u¾|1Î=ŞVµ½Nö­½áW>ª2>ˆè“>·îÛ=ıŒí=E!1>ed>7L>†T>¤è>%îO>Kù«>°;;>b =3è=e^z>2¹<gµ=•4í½Ñ•Š½@Á½vÃ¾€½6Öq½¾¶y£½#îÌ½=½bv>£Ù>úp?>? +Î>ˆ¯T>ûYû>j Ñ>…h½–{2½„|Ë¼Ñİ½^™ ¾Aé¾?ÿ
¾÷)¾ÀÍ½“fI>ûg¡=.Ó£>À)Q½¢.¾ä´ş<!>õú?=lÿ«=F4H>©g=¡)>Jb=ç¼••›=Û¬ü=ëŠ=Ú¸º=¼Ğí½±M½Ë`½.º½#%H½ßêŠ¼i0²½JN‡½wŸ½ÆhÑ=-4N=_›<æ§P½N-¾cE½EÇ ¼Ií›½ÍQ½VÕè>)2>yF?ä“‰½±±3¾xB>\„>Â´J=EØ>ÉH>ˆË/>QŞ¥>jşø¼X_ğ¼s>Ã-G½¥ù¼c’=èÓ>FÇ­>ÛÈâ>M•n>´Ù>E¦Æ>Y‰Â>ø~?qx?67K>ş >¸_>¼éµ;Xşy<{Œl=ØnÖ=íh>øb>ZÒ¦>®ó>øh>jù>Îd¼Ní—=u§¤>İıW>1±>T°=¨F‰½T¡	¾ƒ!<Š4ö½Ö e¾'¼Ï=l#¾*%¾Şi‘>
-=RŠ=7|W>Å$¾çû§½ş– >ºË}»R¢Ÿ<|H¾)×+¾ÏªQ¾Še¾íj¾iêp¾æä¾ÎN¾´7¾.,°½RH/¼ŸÖâ<ß¿"=zG$>´'ë=Beà=Õ3>²T>ü±¾&¾P¾°S¾"¨¾ZB¶¾í9¾j'¬¾ôÃ¾$p3¾Bõ˜¾Î>§¾†F±¾{5â¾²6Ó¾ÓÏ—¾7lÍ¾ÿ¬£¾^J¼ZÙ=s<VÚç<yï=>±Ï!>Ìc=€·>>„2ï=]ı>*È>a,?üà	>¶Ÿs=Z¦>PPÁ>¢ÿ4>6ë{>})½½õAB¾VËl¾æI$¾š„¾MÃ¾Ò²%¾+~°¾=±¾)Öç»õb¾ßX¾25Ø½­°Ì¾Yë¨¾¿@\½ÄƒÃ¾­Ğ¾§à=DF¿=æë=>|ƒz=á¿=¼× >­>tJ>heg>”ñ†>#>”EG>Ç>ğ,§º¾sğ=¦$’>›s;>Æ#m>Œ>¿¤;¼ÙŸ.>98N=Ão›¼PjÎ=–œ[>Ù¢,>E_€>]|È½9W¾.˜]¾ş(¾©¾5L„¾b]ø½hÍV¾·>o¾Ÿ->’‡">¤µj>®á=CÑ!=D>
”½=/o=˜­ë=i™½` í½t}¾ê²¾–„¾şë¾ÈK¾ìT”¾ú¶•¾Çj–>¯Ô=>4ŠŸ>şL">d>	õµ>«˜>ƒgª>ÖˆÎ>o
¾p=‰"¼§C|¾‹ƒ¾3ƒ;¾ ®´¾Zbá¾0¡¾KÏá>ÿÁ>"Ò?˜,Â=¬x=$,V>á”\>ÿ´>İ“Ù>š ½M®½¨½dô¾¶#-¾úG0¾›ß¾Nü¾‹•\¾İè¼½OEÚ½ÿTè½Aá½şU¾<>¾²Ô½ïA¾¯º¾À6€=âU­<ëÑ0½É¼<¡¾ãıá½;½%tÁ½‘¡¦½ÆÇm¾!œ¤¾¸Š™¾…©…¾¯´¾e’Ô¾—‡¾œ1Ã¾IEÇ¾-a›½¬½+úJ;ÖŒ™¾wi¾­½?¯¾6®e¾÷h¾Ò‘Ú; 55» G=àC	¼p\=ì¤=İö=Ûì·=¶P>Í–¾_ªœ¾W½¾´Ë±¾ÂÌ¾Í¾`Ø”¾ÍY¨¾›°¾ŸvS>Qì<WŒ¼Í8
>¹ò½CDè½z‚>
Œ¼’óÄ<N¡¶¾”A¯¾	 G¾ÁÅN¾R @¾jù¼¨¾å™+½\‹'=^öj;ş‰½å¤M½‹–½Ğ¾WÆ¾wÂ½Xø½ØûÛ½Ms%>/ô‘=Ú.F>‡Ûğ=Ÿ™ï=¥b`>VU>Z?>6E>C?ñ½v™B½Z¸=•E±½ä†Z=TK>n|´;ù6Ú=‰[>IÕ>&ÏS½İ¨ä»úo›=Vä½ğ“«½TCÙ= ˆ¾øTn½	$·½ B¾mj ¾/mI¾§¿“¾‰<¾·–u¾úì¨¾ÅŸ¿¾€+i>Z#>>Åg>ô=úÍ©½EŠø:n!ü<­b9¾Ù»Ä‡<QÕD=†‚æ=åA-½›k/>ÙêM>ÉÚ<V’Ï=‘—>Db½¿a¾˜4¾÷À(½Ä@¾R ƒ¾eÀã<Õ3¾Òcg¾°¦¡½H¸‰½‰’Y½*ó½\?¿½ò·½¤¾ûñº½<ê¾)«½Ê] ½F?½›½Í½]tÇ½¦pa½4Ş‘½˜œ½{¥R>NI>ñ_$>iş$>êÜç=¤ÎĞ=mÌ¢=}=S°=/êv½O”½êS‘<<í±½.Ç¦½6á¡¼W÷,¼€¯½L¶½,wZ>Ëj>Ü‡V>uŒw>Í0>’';>Ÿó`>Ó~•=¦ô½=J¢F=«q=—qÏ=İê=ÀÎ=¦¹æ=¬Ó²=Kç=¬~>Xgÿ=½Y=À"¨=P5é=‚=3‡ü=FÇ=
ù>œªg>-€½¹q¾NÜd½t¾ä;¾%½kô½ #¾ñƒ½y>R~2>wù0>È²Œ=-±Â=—Ö=„û~=DÑ=—	=íƒ~½ÍÒÖ½o¬â½ğ½ˆ¨ ¾Œ¼å½¤W½c€½t¤¹½ƒ§ =”½ı<s÷®=“¢»ıœ;ÂRÏ<9–x¼ÏÀ‹<qšg<³I>øc>KL>¬d>¨µA>÷	Z>+šK>õË<>&İ?>¸†=>>W­=†M>2P­>İ>W×Ë=Z>B$>]<›}<½ì´<0];·ir<\à:=º#=Õj…=xò‹=Ôæš=`>˜òH>Im‚>cü&>’l>Ax>pP>âVe>®tr>¡89¾VøJ¾Wí¾	 ¾¼z6¾ûv¾îË‚½5±È½ĞÌ­½ó•>4ñY>±©v>`å‡>—2>(±H>ËH<>ù-³=6ƒ=!Ü½ÖÏ¦½ä-½!¸½--´½”&Ç½IjÁ½rk½B›½Ë#2½è¬”½a€Ï¼r´=ÅbŒ½°½”nŒ=LFC½šZ)¾˜ş¾í#6¾æ½¾fi¾û­$¾d*¾ÏÃ¾ISû½Í‡	¾Å{¾´ìw¾ëüq¾M¨J¾â^¾2çA¾Ê—A¾ŠÌ?¾ÚÚ¾VL =Ÿ*Í=ò>€'=Åv–=³@è=ç›n=óx…=YÄ=o´©=¬”Ò=4#>+Ù=Ù°=_Ò>:°†=öÌ=c>ª	³=B=Ön
>sQë=Hp·=Uş>Å¶+>šÀ >g³.>+uq½…xª¼ªúà=­F¼ªşv<3Pº=U–Š>G™â=>e‰>Ç½Ë<GÛ›;£4>­qÍ<\û<É[>‹=Å=¼ø=†ÑÑ½<‘¼¼y‡H=kµ$¾ğ¸‹½‹ğ;6Ü¯½Í Y¼|½»7ÀK¾Ÿ¾™u¾Úy½ü©§½@Tˆ¼è†<iô·=ŠÀ=4qÏ½‘…µ½¥­Ğ½’¾ğ³¾¨åt½îµ´½Ípv½Ù	F½íw’½$AÏ½»á¼Ë
=†Æ„»Uœˆ=ÄT>©´=Õ+>~Ò>
Û¦>û¡>hÍ>Ôs^>ù™q>ı)º>Ye7>*¼>°äÔ½ÄâÜ½@®½­©Ê½ Œï½"o½fŞ½âŒÜ½ô¬›½‡¿”½†O¾|ôÙ;¦,º½ÎÁ½qB«<Š›½Ø‘½‚Z=q«Î½O¾ (ó½/Á½:Ó¾¶"ü½á8½\ò½®[§¼'¤“=O>Y=ì7=½wmÒ<i7=|Óˆ=FÔD=Ç’=º->úùñ=Iu„=öªM>*/¢=?<CŠ>K^G¼Òn»“—³=‚&c>‡->Ì“2>yº_>rß$>:,>Úˆ>A>kÍ\>H°¾n™T¾Öî¾ìç¾!Õ¾=ò½Ìt?¾B$¾?Å¾/B!¾ëµ¾^+¾° +¾¶ô¾ÕM?¾õø¾Øg)¾©Æd¾Ú±(¾ª¹‰¾nÑƒ¾tıH¾%y‚¾€¦a¾1y¾È¶5¾ÈÓù½\ >•Âh>T X>,1x>µ>Ñô=y#>\e¯=¸=µ²¡¾M“¾Ë¡z¾'¨¾,¨}¾‹Â0¾®>i¾=,¾Î,¾$§5=®»c„»Ù7>í=D/Õ=9ƒ†>œ0>m*>FçÅ½c8©½#o\½7}¾½†£L½ÆF½ëºˆ½Ÿ% ½ZÛ <„Ä½½5İ½Óåt¼Í½ç¹p½zc=´Z¨=è7`=ù«>Hn’>i”‡>aê>¼o>‡Ú>>…É1>Dî.>ĞC£=$é%=8 »6Ú¼.H½ºX›¼®ía¼Êâ=÷Ô=âºõ=„o»=|ó<¢8<dxÏ=Ú/ı;ÄÇ.½WEØ=”<Ög«<#„ı=øe¬½uj>½æ—¼ì´ç½Ì4¾wjO½ıƒ½šB¡½„.¼Œ5Û¼/–™½òRµ;j7µ=ÅzK=ÀîÉ<B~C>³£u>\}G>Ì‹3¾7à¾*m<¾ssù½?*Å½ &Õ½§|½ şS½áé£½ÑÂˆ=×€={² = åD<TV=z±W=;³=ş¸ºw;e<¸kÌ=•;>ÁĞ1>eºè=lK>†ƒ>UĞR>T~> 8‹>‡¾¤ò¼½³ÿİ½,İ.¾Óuï½GÓÁ½ë#¾Éß—½o½ÄuÉ½µÀ¾Lz¾*d½“&Ç½Œª´½¬5…=ŞŞ¶<$B	½±Ã’>È!Y>ÈIz>"ŸB>“Y8>S>2Å>Xä=ÿ=Dï`¾^e•¾?„¾*çK¾•†—¾×ÿZ¾¾~n:¾;7¾áÿ¼S®½ÊŸî»ş¦=™—Y=;´i=Æà6=öõñ=¯¾Á=“^>c7æ=q/ü=¾>„>]y=‘=„Å>‘êš=8yÖ»¾ğG¾_éÆ½ÚAo=e’S¾]ı½#äû=3¾A¾HÙq½Nš
>íwÔ½‘EÛ½™E ¾Êé¾}¼v½—œ¾+X¾•P±¼é°¬½wÓÊ=¯Ş‚=ó ˜=jÑ=?°;ÁW†=P:Ÿ=ÛW†=.„ñ=©$;½"éƒ½îyŸ½šLö½Ó¾¢æG¾»ew¾–Ä„¾(-z¾Z¤M¾5ç-¾zf(¾Gz-¾3» ¾­®û½Ñ¾µÉ ¾01‡½ ,O=u\3ºaÚq<LB:>àH~=
¼g¢ˆ>Ä´=•½‘ÒË¼Õü|½`Ÿ¼¯Ş½ÜXÕ½×ß’½ »v…R½ª÷G½ùN+>ÆY>mÁó=Oµô=¸ç°=½{>„@›=QK <Ô“=2<¿1K=Æm=Dy½wéë;AÀ+=}ï=ÿ£e<Y¼¿=åd*>BÂ÷=¸ş>”¬$>¶ =J ¯=óò=biÇ=B~=°	¾Ïë%¾©&¾÷!¾Ñ-¾ïÂ½[6*¾÷Î'¾Ñî½»¡;¾%B¾ÇC¾ÚÊ¾.×G¾¦K¾¶0¾Ö‡õ½hğÖ½ëv›½º¾½®±½÷PË½ho!¾i	ª¼»=¹;¹K½¹J¯ºñ†œ> >,Š>Š—©>½Ët>qCS>Gµª>.i6>Ş8>Qx0¾Cù¾1ë¾\¾¢È½¡:¾/©¾¼šÅ½˜®½‚İ§½/˜½t›v½•j‘½%
ù½±FI½†Ÿ½B‚½ÿH†½ZÒa¾ñue¾t¾RYN¾,¾;ÁB¾O2¾ŸùŞ½º¦½Êû=ÿs­=w|ï=ß¬ø=„,û=|«>~=c>øOO>[B>=>£ >c½=>²0>Fä>Ş¸>İ¡ö=îZ¨=Fb•=,$C=8 í¸•È}=œÖØ;°E½ò	=×âé¼íÇº¼b=)†>xd>İ¥>É3a>›qa>Ø ƒ>`€>¸kc>\Í>÷p}½§¾¦=¾t†½îë½Å\¾¬›<æ’½#Ò'½
Œõ¼;9]½[¼î<¶±&½Hb¯½òÆĞ<‰S¼±…½ÌS~<ñº?>.Í=©Q>«°]>ıe>ú}k>m÷n>XA:>4Sc>ÉF¾ÇÖÆ½-f¾ğË½š¾,p¾ñâu<ÑÉb½š'¾ÙŒ½rál½é¼Bš½I'¶½KZ½ZcŸ¼ªÃ&½»r½øó±½(ëÇ½ßò½Ğ™½²º½}ğµ½CÄººò,½a3ô¼d¨=B="